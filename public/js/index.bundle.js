!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),o=(s.prototype.width=function(){return this.drag.$el.offsetWidth},s.prototype.height=function(){return this.drag.$el.offsetHeight},s.prototype.setContent=function(t){this.$contentBox.append(t)},s.prototype.remove=function(){this.$el.remove()},s.prototype.select=function(){this.$topBar.show(),this.$bottomBar.show(),this.$contentBox.addClass("selected"),this.resetPositionInfo()},s.prototype.resetPositionInfo=function(){var t=this.drag.$el.style.left,e=this.drag.$el.style.top;this.$inputX.val(parseInt(t||0)),this.$inputY.val(parseInt(e||0)),this.$inputWidth.val(this.width()),this.$inputHeight.val(this.height())},s.prototype.unselect=function(){this.$topBar.hide(),this.$bottomBar.hide(),this.$contentBox.removeClass("selected")},s.prototype.mount=function(t){var e=this;this.stage=t,this.id=t.getRandomStr(4),t.$canvas.append(this.$el);var i=new n.default(this.$el[0],{allowOverstep:"hidden"!==t.props.overflow,minWidth:this.minWidth,minHeight:this.minHeight,dragAnchor:this.$contentBox[0]});(this.drag=i).onMove=function(){e.resetPositionInfo()},i.onResize=function(){e.resetPositionInfo()},this.$contentBox.on("mousedown",function(i){t.curSelectedComponent!=e&&t.selectComponent(e)}),this.$topBar.find(".delete").on("mousedown",function(i){i.stopPropagation(),t.removeComponent(e)}),this.$topBar.on("mousedown",function(t){t.stopPropagation()}),this.$bottomBar.on("mousedown",function(t){t.stopPropagation()})},s);function s(t){void 0===t&&(t=""),this.props={},this.formData={},this.name=t;var e=$('\n      <div class="component-box">\n        <div class="top-bar">\n          <span class="setting" title="编辑"></span>\n          <span class="lock"></span>\n          <span class="delete"></span>\n        </div>\n        <div class="content-box">\n        </div>\n        <div class="bottom-bar">\n          <span>X:<input type="text" value="0"></span>\n          <span>Y:<input type="text" value="0"></span>\n          <span>宽:<input type="text" value="0"></span>\n          <span>高:<input type="text" value="0"></span>\n          <span class="confirm">确定</span>\n        </div>\n      </div>\n    ');this.$contentBox=e.find(".content-box"),t&&e.addClass(t),this.$el=e,this.$topBar=e.find(".top-bar"),this.$bottomBar=e.find(".bottom-bar"),this.minWidth=24,this.minHeight=24,this.$inputX=this.$bottomBar.find("span:nth-child(1) input"),this.$inputY=this.$bottomBar.find("span:nth-child(2) input"),this.$inputWidth=this.$bottomBar.find("span:nth-child(3) input"),this.$inputHeight=this.$bottomBar.find("span:nth-child(4) input")}e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(o.prototype.init=function(){"string"==typeof this.$el&&(this.$el=document.querySelector(this.$el));var t=this.option;t.parent&&"string"==typeof t.parent&&(this.option.parent=document.querySelector(t.parent)),t.alignLineColor||(t.alignLineColor="#FF4AFF"),t.alignGap||(t.alignGap=3),t.resizeGap||(t.resizeGap=5),t.alignLineSize||(t.alignLineSize=1),void 0===t.isShowDist&&(t.isShowDist=!0),void 0===t.resizable&&(t.resizable=!0),void 0===t.minWidth&&(t.minWidth=24),void 0===t.minHeight&&(t.minHeight=24),this.setupEvent()},o.prototype.isTouch=function(){return"ontouchstart"in window},o.prototype.stopPropagation=function(t){window.event?window.event.cancelBubble=!0:t.stopPropagation()},o.prototype.getEventInfo=function(t){return this.isTouch()?t.targetTouches[0]:t},o.prototype.checkResize=function(t,e,i){var n=t.getBoundingClientRect(),o=this.option.resizeGap,s=this.resizeFlags;return e>=n.right-o&&e<=n.right&&i>=n.top&&i<=n.top+o?s[4]:e>=n.left&&e<=n.left+o&&i>=n.top&&i<=n.top+o?s[5]:e>=n.right-o&&e<=n.right&&i>=n.bottom-o&&i<=n.bottom?s[6]:e>=n.left&&e<=n.left+o&&i>=n.bottom-o&&i<=n.bottom?s[7]:i>=n.top&&i<=n.top+o?s[0]:e>=n.right-o&&e<=n.right?s[1]:i>=n.bottom-o&&i<=n.bottom?s[2]:e>=n.left&&e<=n.left+o?s[3]:null},o.prototype.darg=function(t){var e,i,n=this,o=this.EVENTS,s=0,a=0,l=0,r=0,p=this.option.parent||this.$el.offsetParent,c=0,h=0,d=this.option,u=n.getEventInfo(t);function g(t){var e=n.getEventInfo(t),i=e.clientX-s,o=e.clientY-a,p=d.minLeft?d.minLeft:0,u=d.minTop?d.minTop:0;n.option.allowOverstep||(i<p&&(i=p),o<u&&(o=u),c<i+l&&(i=c-l),h<o+r&&(o=h-r)),n.$el.style.position="absolute",n.$el.style.left=i+"px",n.$el.style.top=o+"px",n.option.alignDrags&&n.checkAlign(),n.onMove&&n.onMove(e)}n.isDrag=!0,s=u.clientX-n.$el.offsetLeft,a=u.clientY-n.$el.offsetTop,l=n.$el.offsetWidth,r=n.$el.offsetHeight,e=document.documentElement.clientWidth,i=document.documentElement.clientHeight,c=p.clientWidth||e,h=p.clientHeight||i,document.addEventListener(o[1],g),document.addEventListener(o[2],function t(e){var i=n.getEventInfo(e);n.isDrag=!1,document.removeEventListener(o[1],g),document.removeEventListener(o[2],t),n.onEnd&&n.onEnd(i),n.clearAlignLine()}),n.onStart&&n.onStart(u)},o.prototype.resize=function(t){var e=this.EVENTS,i=this,n=(t=this.getEventInfo(t)).clientX,o=t.clientY,s=this.$el.offsetHeight,a=this.$el.offsetWidth,l=s,r=a,p=parseInt(this.getStyle(this.$el,"top")),c=parseInt(this.getStyle(this.$el,"left")),h=p,d=c;this.isResizing=!0;var u=this.option.parent||this.$el.offsetParent,g=document.documentElement.clientWidth,f=document.documentElement.clientHeight,m=u.clientWidth||g,v=u.clientHeight||f,y=this.option.minWidth,b=this.option.minHeight;function $(t){var e=t.clientY-o;(s-=e)<b&&(s=b),h+l<s&&(s=h+l),(p+=e)<0&&(p=0),h+(l-b)<p&&(p=h+(l-b)),i.$el.style.top=p+"px",i.$el.style.height=s+"px"}function x(t){(a+=t.clientX-n)<y&&(a=y),m-d<a&&(a=m-d),i.$el.style.width=a+"px"}function w(t){(s+=t.clientY-o)<b&&(s=b),v-h<s&&(s=v-h),i.$el.style.height=s+"px"}function E(t){(a-=t.clientX-n)<y&&(a=y),d+r<a&&(a=d+r),(c+=t.clientX-n)<0&&(c=0),d+(r-y)<c&&(c=d+(r-y)),i.$el.style.left=c+"px",i.$el.style.width=a+"px"}function C(t){t=i.getEventInfo(t),i.resizeFlag===i.resizeFlags[0]?$(t):i.resizeFlag===i.resizeFlags[1]?x(t):i.resizeFlag===i.resizeFlags[2]?w(t):i.resizeFlag===i.resizeFlags[3]?E(t):i.resizeFlag===i.resizeFlags[4]?($(t),x(t)):i.resizeFlag===i.resizeFlags[5]?($(t),E(t)):i.resizeFlag===i.resizeFlags[6]?(w(t),x(t)):i.resizeFlag===i.resizeFlags[7]&&(w(t),E(t)),o=t.clientY,n=t.clientX,i.onResize&&i.onResize()}document.addEventListener(e[1],C),document.addEventListener(e[2],function t(n){i.isResizing=!1,document.removeEventListener(e[1],C),document.removeEventListener(e[2],t)})},o.prototype.start=function(t){t.preventDefault(),this.stopPropagation(t),this.resizeFlag?this.resize(t):this.darg(t)},o.prototype.setupEvent=function(){var t=this,e=this.EVENTS,i=this,n=this.option.dragAnchor?this.option.dragAnchor:this.$el;this.option.resizable&&n.addEventListener(e[1],function(e){if(!t.isResizing){var o=i.getEventInfo(e),s=i.checkResize(n,o.clientX,o.clientY);t.resizeFlag=s,n.style.cursor=s||"move"}}),n.addEventListener(e[0],this.start.bind(this))},o.prototype.setAlignDrags=function(t){this.option.alignDrags=t},o.prototype.getStyle=function(t,e){return window.getComputedStyle?document.defaultView.getComputedStyle(t,null).getPropertyValue(e):t.currentStyle?t.currentStyle[e]:null},o.prototype.getClientRect=function(t){var e=t.getBoundingClientRect(),i=this.option.parent||this.$el.offsetParent,n={},o=parseInt(this.getStyle(i,"border-left-width")),s=parseInt(this.getStyle(i,"border-top-width")),a=i.getBoundingClientRect();return n.left=e.left-a.left-o,n.top=e.top-a.top-s,n.right=n.left+e.width,n.bottom=n.top+e.height,n.width=e.width,n.height=e.height,n},o.prototype.isAlign=function(t,e){var i=this.option.alignGap;return Math.abs(t-e)<=i},o.prototype.clearAlignLine=function(){Array.apply(null,document.querySelectorAll(".align-line")).forEach(function(t){t.parentNode.removeChild(t)})},o.prototype.createDistText=function(t,e,i){var n=this.option.alignLineColor,o=i.top,s=i.bottom,a=i.left,l=i.right,r=i.width,p=i.height,c=r/2,h=p/2,d=e.width/2,u=e.height/2,g=document.createElement("div");g.style.position="absolute",g.style.textAlign="center";var f=document.createElement("span"),m=0;f.style.background=n,f.style.borderRadius="2px",f.style.lineHeight="14px",f.style.padding="0 2px",f.style.fontSize="10px",f.style.color="#ffffff",f.style.userSelect="none",g.appendChild(f);var v=this.alignFlags;if(t===v[0]||t===v[1]||t===v[3]||t===v[4]){if(g.style.bottom="0px",a<e.left?(m=e.left-l,g.style.left=r+"px"):(m=a-e.right,g.style.left=e.width+"px"),(m=Math.round(m))<0)return null;g.style.width=m+"px",g.style.paddingBottom="2px",f.innerText=m+"px"}else if(t===v[2]||t===v[10]||t===v[11]){if(g.style.bottom="0px",a<e.left?(m=e.left-l,g.style.left=c+"px"):(m=a-e.right,g.style.left=d+"px"),(m=Math.round(m))<0)return null;g.style.paddingBottom="2px",g.style.width=m+"px",f.innerText=m+"px"}else if(t===v[5]||t===v[6]||t===v[8]||t===v[9]){if(g.style.left="0px",o<e.top?(m=e.top-s,g.style.top=p+"px"):(m=o-e.bottom,g.style.top=e.height+"px"),(m=Math.round(m))<0)return null;f.style.position="absolute",f.style.top="50%",f.style.marginTop="-7px",f.style.left="2px",g.style.height=m+"px",f.innerText=m+"px"}else if(t===v[7]||t===v[12]||t===v[13]){if(g.style.left="0px",o<e.top?(m=e.top-s,g.style.top=h+"px"):(m=o-e.bottom,g.style.top=u+"px"),(m=Math.round(m))<0)return null;f.style.position="absolute",f.style.top="50%",f.style.marginTop="-7px",f.style.left="2px",g.style.height=m+"px",f.innerText=m+"px"}return g},o.prototype.showAlignLine=function(t,e){var i=e.flag,n=e.dragElemRect,o=e.alignElemRect,s=(e.alignDrag,this.option.alignLineSize),a=this.option.alignLineColor,l=o.top,r=o.bottom,p=o.left,c=o.right,h=o.width/2,d=o.height/2,u=n.width/2,g=n.height/2,f={},m=this.alignFlags;i===m[0]||i===m[1]?(f.left=p<n.left?p:n.left,f.top=l,f.bottom=f.top+s,f.right=c>n.right?c:n.right):i===m[2]?(f.top=l+d,f.bottom=f.top+s,p===n.left&&c===n.right?(f.left=p,f.right=c):p>n.left&&c<n.right?(f.left=n.left,f.right=n.right):p<n.left&&c>n.right?(f.left=n.left+u,f.right=c):(f.left=p<n.left?p+h:n.left+u,f.right=c>n.right?c-h:n.right-u)):i===m[3]||i===m[4]?(f.left=p<n.left?p:n.left,f.top=r,f.bottom=f.top+s,f.right=c>n.right?c:n.right):i===m[5]||i===m[6]?(f.left=p,f.top=l<n.top?l:n.top,f.bottom=r>n.bottom?r:n.bottom,f.right=f.left+s):i===m[7]?(f.left=p+h,l===n.top&&r===n.bottom?(f.top=l,f.bottom=r):l>n.top&&r<n.bottom?(f.top=n.top,f.bottom=n.bottom):l<n.top&&r>n.bottom?(f.top=l,f.bottom=n.top+g):(f.top=l<n.top?l+d:n.top+g,f.bottom=r>n.bottom?r-d:n.bottom-g),f.right=f.left+s):i===m[8]||i===m[9]?(f.left=c,f.top=l<n.top?l:n.top,f.bottom=r>n.bottom?r:n.bottom,f.right=f.left+s):i===m[10]||i===m[11]?(f.top=l+d,f.bottom=f.top+s,p===n.left&&c===n.right?(f.left=p,f.right=c):p>n.left&&c<n.right?(f.left=n.left,f.right=n.right):(f.left=p<n.left?p+h:n.left+u,f.right=c>n.right?c:n.right)):i!==m[12]&&i!==m[13]||(f.left=p+h,l===n.top&&r===n.bottom?(f.top=l,f.bottom=r):l>n.top&&r<n.bottom?(f.top=n.top,f.bottom=n.bottom):(f.top=l<n.top?l+d:n.top+g,f.bottom=r>n.bottom?r:n.bottom),f.right=f.left+s);var v=document.createElement("div");v.style.position="absolute",v.style.top=f.top+"px",v.style.left=f.left+"px";var y=f.right-f.left;y=y;var b=f.bottom-f.top;b=b,v.style.width=y+"px",v.style.height=b+"px",v.style.background=a,v.style.zIndex="9999999999999",v.className="align-line";var $=this.createDistText(i,n,o);this.option.isShowDist&&$&&v.appendChild($),t.appendChild(v)},o.prototype.checkAlign=function(){var t=this,e=this.$el,i=this.option.alignDrags,n=this.getClientRect(this.option.alignAnchor?this.option.alignAnchor:e),o=[];this.clearAlignLine();var s=this.alignFlags;i.forEach(function(e){if(e!==t){var i=e.$el,a=t.getClientRect(e.option.alignAnchor?e.option.alignAnchor:i),l=a.top,r=a.height,p=a.bottom,c=a.left,h=a.width,d=a.right,u=n.width/2,g=h/2,f=n.height/2,m=r/2;if(t.isAlign(n.top+f,l+m)){var v={flag:s[2],alignDrag:e,dragValue:l+m-f,alignElemRect:a,dragElemRect:n};o.push(v)}else t.isAlign(n.top,l)?(v={flag:s[0],dragValue:l,alignDrag:e,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.bottom,l)?(v={flag:s[1],alignDrag:e,dragValue:l-n.height,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.bottom,p)?(v={flag:s[3],alignDrag:e,dragValue:p-n.height,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.top,p)?(v={flag:s[4],alignDrag:e,dragValue:p,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.top,l+m)?(v={flag:s[10],alignDrag:e,dragValue:l+m,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.bottom,p-m)&&(v={flag:s[11],alignDrag:e,dragValue:p-m-n.height,alignElemRect:a,dragElemRect:n},o.push(v));t.isAlign(n.left+u,c+g)?(v={flag:s[7],alignDrag:e,dragValue:c+g-u,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.left,c)?(v={flag:s[5],alignDrag:e,dragValue:c,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.right,c)?(v={flag:s[6],alignDrag:e,dragValue:c-n.width,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.right,d)?(v={flag:s[8],alignDrag:e,dragValue:d-n.width,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.left,d)?(v={flag:s[9],alignDrag:e,dragValue:d,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.left,c+g)?(v={flag:s[12],alignDrag:e,dragValue:c+g,alignElemRect:a,dragElemRect:n},o.push(v)):t.isAlign(n.right,d-g)&&(v={flag:s[13],alignDrag:e,dragValue:d-g-n.width,alignElemRect:a,dragElemRect:n},o.push(v))}});var a=this.option.parent||this.$el.offsetParent;o.forEach(function(i){var n=i.flag.split("_")[0];if(t.option.alignAnchor){var o=0;"left"===n?o=t.option.alignAnchor.offsetLeft:"top"===n&&(o=t.option.alignAnchor.offsetTop),e.style[n]=i.dragValue-o+"px"}else e.style[n]=i.dragValue+"px";(t.option.isShowDist||i.alignDrag.option.isShowDist)&&t.showAlignLine(a,i)}),this.onAlign&&0<o.length&&this.onAlign(o)},o);function o(t,e){void 0===e&&(e={}),this.EVENTS=[],this.resizeFlags=["n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize"],this.alignFlags=["top_tt","top_bt","top_cc","top_bb","top_tb","left_ll","left_rl","left_cc","left_rr","left_lr","top_tc","top_bc","left_lc","left_rc"],this.isDrag=!1,this.isResizing=!1,this.$el=t,this.option=e,this.EVENTS=this.isTouch()?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"],this.init()}e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i(3),i(4),i(5),i(6);var n=i(7),o=i(11),s=i(14),a=i(15);$(function(){var t=new a.default,e=new n.default(t);e.createStage(),new o.default(e),new s.default(e)})},function(t,e,i){},function(t,e,i){},function(t,e,i){},function(t,e){Array.prototype.remove=function(t){var e=this.indexOf(t);-1<e&&this.splice(e,1)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(8),o=(s.prototype.createStage=function(){var t=new n.default;t.create(this.$el),this.curStage=t,this.stages.push(t),this.pageConfig.setStage(t)},s);function s(t){this.stages=[],this.curStage=null,this.pageConfig=t;var e=$(".stage-ct");this.stages=[],this.$el=e}e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(1),o=i(9),s=i(10),a=(l.prototype.create=function(t){var e,i,s,a,l=this,r=this.pageWidth,p=this.pageHeight,c=$('<div class="stage"></div>');t.append(c),e=$('\n      <div class="canvas-wrap">\n        <div>\n          <div class="canvas-box">\n            <div class="canvas">\n            </div>\n          </div>\n        </div>\n      </div>\n    '),this.paddingWidth=100*Math.ceil(c.width()/100),this.paddingHeight=100*Math.ceil(c.height()/100),this.isRuler?((a=new o.default).create(c),c.append(e)):(c.append(e),e.css("left",0),e.css("top",0)),i=e.find("> div"),s=e.find(".canvas"),this.$canvas=s,this.$canvasBox=e.find(".canvas-box"),this.$canvasWrap=e,this.$el=c,this.ruler=a,this.$scrollContent=i,this.myScroll=new IScroll(e[0],{scrollX:!0,freeScroll:!0,startX:0,startY:0,probeType:3,scrollbars:!0,mouseWheel:!0,interactiveScrollbars:!0,disableMouse:!0,disablePointer:!0,disableTouch:!0}),this.layoutCanvas(r,p),this.myScroll.on("scroll",function(){a&&(a.setX(this.x),a.setY(this.y))});var h=a.$rulerX[0],d=a.$rulerY[0],u=this.EVENTS;h.addEventListener(u[0],function(t){var e=$('<div class="guide-line guide-lineX"><div></div></div>');l.$el.append(e);var i=new n.default(e[0],{isShowDist:!1,alignAnchor:e[0].children[0],minLeft:20,resizable:!1,allowOverstep:!1});e.css("top",t.clientY-l.$el[0].getBoundingClientRect().top-i.option.alignAnchor.offsetTop+"px"),i.start(t),i.onEnd=function(t){i.$el.offsetTop<=15&&$(i.$el).remove()},l.drags.push(i),l.resetAlignElements()}),d.addEventListener(u[0],function(t){var e=$('<div class="guide-line guide-lineY"><div></div></div>');l.$el.append(e);var i=new n.default(e[0],{isShowDist:!1,alignAnchor:e[0].children[0],minTop:20,resizable:!1,allowOverstep:!1});e.css("left",t.clientX-l.$el[0].getBoundingClientRect().left-i.option.alignAnchor.offsetLeft+"px"),i.start(t),i.onEnd=function(t){i.$el.offsetLeft<=15&&$(i.$el).remove()},l.drags.push(i),l.resetAlignElements()}),this.setupEvent()},l.prototype.layoutCanvas=function(t,e){var i,n,o,s,a,l;i=this.paddingWidth/2,n=this.paddingHeight/2,o=50*Math.ceil(t/50)+this.paddingWidth,s=50*Math.ceil(e/50)+this.paddingHeight,a=t<this.$canvasWrap.width()?o/2-this.$canvasWrap.width()/2:this.paddingWidth/2,l=e<this.$canvasWrap.height()?s/2-this.$canvasWrap.height()/2:this.paddingHeight/2,this.ruler.update(t,e,this.paddingWidth,this.paddingHeight),this.ruler&&(this.ruler.setX(-a),this.ruler.setY(-l)),this.$canvas.width(t),this.$canvas.height(e),this.$canvasBox.width(t),this.$canvasBox.height(e),this.$canvasBox.css("margin-left",i+"px"),this.$canvasBox.css("margin-top",n+"px"),this.$scrollContent.width(o),this.$scrollContent.height(s),this.myScroll.scrollTo(-a,-l),this.myScroll.refresh()},l.prototype.setCanvasSize=function(t,e){this.pageWidth=t,this.pageHeight=e,this.layoutCanvas(t,e)},l.prototype.setupEvent=function(){var t=this,e=this.EVENTS,i=this.$el[0],n=this.$canvas[0];i.addEventListener(e[1],function(e){var i=n.getBoundingClientRect(),o=t.getEventInfo(e),s=o.clientX-i.left,a=o.clientY-i.top;0<=s&&0<=a&&s<t.$canvas.width()&&a<t.$canvas.height()?(t.ruler.setCursorPos(s,a),t.ruler.showCursor()):t.ruler.hideCursor()}),n.addEventListener(e[0],function(i){var o=n.getBoundingClientRect();t.unselectComponent(),console.log("canvas down");var a=t,l=t.getEventInfo(i),r=l.clientX,p=l.clientY,c=new s.default;function h(t){var e,i,n,s,l=(t=a.getEventInfo(t)).clientX,h=t.clientY;n=l<r?r-(e=l):l-(e=r),s=h<p?p-(i=h):h-(i=p),a.setElementPos(c.$el,e-o.left,i-o.top,n,s)}t.addComponent(c),document.addEventListener(e[1],h),document.addEventListener(e[2],function t(i){(c.width()<c.minWidth||c.height()<c.minHeight)&&a.removeComponent(c),document.removeEventListener(e[1],h),document.removeEventListener(e[2],t)})})},l.prototype.unselectComponent=function(){this.curSelectedComponent&&(this.curSelectedComponent.unselect(),this.curSelectedComponent=null)},l.prototype.selectComponent=function(t){null!=this.curSelectedComponent&&this.curSelectedComponent!=t&&this.curSelectedComponent.unselect(),t.select(),this.curSelectedComponent=t},l.prototype.setElementPos=function(t,e,i,n,o){t.css("left",e+"px"),t.css("top",i+"px"),t.css("width",n+"px"),t.css("height",o+"px")},l.prototype.isTouch=function(){return"ontouchstart"in window},l.prototype.getEventInfo=function(t){return this.isTouch()?t.targetTouches[0]:t},l.prototype.resetAlignElements=function(){var t=this;this.drags.forEach(function(e){e.setAlignDrags(t.drags)})},l.prototype.removeComponent=function(t){t.remove(),this.components.remove(t),this.drags.remove(t.drag)},l.prototype.addComponent=function(t){t.mount(this),this.drags.push(t.drag),this.components.push(t),this.resetAlignElements()},l.prototype.setComponentAllowOverstep=function(t){this.components.forEach(function(e){e.drag.option.allowOverstep=t})},l.prototype.generateJsonCode=function(){var t=this;return this.props.width=this.pageWidth,this.props.height=this.pageHeight,this.props.app=[],this.components.forEach(function(e){t.props.app.push(e.getProps())}),JSON.stringify(this.props)},l.prototype.generateHtmlCode=function(){var t=[];return this.components.forEach(function(e){t.push(e.toHtml())}),'<div style="position: relative; overflow: hidden;width: '+this.pageWidth+"; height: "+this.pageHeight+"px;background: "+this.props.bgColor+';">\n      '+t.join("")+"\n    </div>"},l.prototype.getRandomStr=function(t){for(var e=[],i=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9"];t--;)e.push(i[Math.floor(i.length*Math.random())]);return e.join("")},l);function l(){this.EVENTS=[],this.isRuler=!0,this.drags=[],this.curSelectedComponent=null,this.components=[],this.pageWidth=1920,this.pageHeight=2561,this.props={bgColor:"#FFFFFF",position:"50% 0%",overflow:"hidden"},this.EVENTS=this.isTouch()?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"],this.id=this.getRandomStr(5)}e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(o.prototype.create=function(t){var e=$('\n      <div class="ruler">\n        <div class="rulerX">\n          <div>\n            <div class="cursor-pos"><span>0</span></div>\n          </div>\n        </div>\n        <div class="rulerY">\n          <div>\n            <div class="cursor-pos"><span>0</span></div>\n          </div>\n        </div>\n      </div>\n    '),i=e.find(".rulerX > div"),n=e.find(".rulerY > div");this.$el=e,this.$rulerX=i,this.$rulerY=n,this.$cursorPosX=i.find(".cursor-pos"),this.$cursorPosY=n.find(".cursor-pos"),t.append(this.$el)},o.prototype.draw=function(){var t=this.canvasWidth,e=this.canvasHeight,i=this.paddingWidth,n=this.paddingHeight,o=50*Math.ceil(t/50)+i,s=50*Math.ceil(e/50)+n;this.paddingHeight=n,this.paddingWidth=i,this.width=o,this.height=s;for(var a=-i/2,l="",r=0;r<o/50;r++)l+="<span>"+Math.abs(a+50*r)+"</span>";var p=-n/2,c="";for(r=0;r<s/50;r++)c+="<span>"+Math.abs(p+50*r)+"</span>";this.$rulerX.append(l),this.$rulerX.width(o),this.$rulerY.append(c),this.$rulerY.height(s)},o.prototype.update=function(t,e,i,n){this.canvasWidth=t,this.canvasHeight=e,this.paddingWidth=i,this.paddingHeight=n,this.$rulerX.find("> span").remove(),this.$rulerY.find("> span").remove(),this.draw()},o.prototype.showCursor=function(){this.$cursorPosX.show(),this.$cursorPosY.show()},o.prototype.hideCursor=function(){this.$cursorPosX.hide(),this.$cursorPosY.hide()},o.prototype.setCursorPos=function(t,e){this.$cursorPosX.css("left",this.paddingWidth/2+t+"px"),this.$cursorPosY.css("top",this.paddingHeight/2+e+"px"),this.$cursorPosX.find("span").text(Math.ceil(t)),this.$cursorPosY.find("span").text(Math.ceil(e))},o.prototype.setX=function(t){this.$rulerX.css("left",t+"px")},o.prototype.setY=function(t){this.$rulerY.css("top",t+"px")},o);function o(){}e.default=n},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var s,a=i(0),l=(o(r,s=a.default),r.prototype.getProps=function(){return{}},r.prototype.toHtml=function(){return""},r);function r(){var t=s.call(this,"hotarea-component")||this;return t.$contentBox.append('\n        <div class="hot-area-box"></div>\n      '),t}e.default=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(12),o=i(13);e.default=function(t){this.stageCt=t;var e=$(".component-list");this.$el=e;var i=t.curStage;e.find("li").bind("mousedown",function(t){var e=$(this).data("name"),s=null,a=Math.abs(i.myScroll.x)-i.paddingWidth/2,l=Math.abs(i.myScroll.y)-i.paddingHeight/2;"img-component"===e?s=new n.default:"text-component"===e&&(s=new o.default),s.$el.css("left",Math.max(a,0)+"px"),s.$el.css("top",Math.max(l,0)+"px"),i.addComponent(s),i.selectComponent(s)})}},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var s,a=i(0),l=(o(r,s=a.default),r.prototype.toHtml=function(){var t,e,i,n;t=this.$el.css("top"),e=this.$el.css("left"),i=this.$el.width(),n=this.$el.height();var o="",s="url("+this.formData.bgImg+") 50% 50% no-repeat;";return"cut"===this.props.imgMode?s="url("+this.formData.bgImg+") 50% 50% no-repeat;":o=this.$img[0].outerHTML,'<a href="'+this.formData.href+'" target="'+(this.formData.hrefMode||"")+'" style="position: absolute; top: '+t+"; left: "+e+"; width: "+i+"px; height: "+n+";background: "+s+'">\n      '+o+"\n    </a>"},r.prototype.initFormData=function(){this.formData.bgImg="https://img.alicdn.com/imgextra/i2/280837244/TB2orubcrJmpuFjSZFwXXaE4VXa-280837244.jpg",this.formData.bgColor="",this.formData.appLabel="",this.formData.imgMode="cut",this.formData.linkMode="unlink",this.formData.href="",this.formData.tipText="",this.formData.animType="",this.formData.hrefMode=!1,this.formData.bgImgSize=!1,this.formData.animSpeed="1s",this.formData.animRange="-s",this.$content.css("background-image","url("+this.formData.bgImg+")"),this.$content.css("background-color",this.formData.bgColor),this.$img.attr("src",this.formData.bgImg)},r.prototype.openEditDialog=function(){var t=this,e=layui.layer,i=null,n=e.open({type:1,title:"单图设置",skin:"layui-layer-rim",area:["600px","600px"],success:function(n,o){i=$(n),void 0===t.formData.animType&&(t.formData.animType=""),i.find('.animselect > div[data-val="'+t.formData.animType+'"]').addClass("active"),i.find(".animselect > div").on("click",function(){i.find(".animselect > div.active").removeClass("active"),$(this).addClass("active")}),t.formData.bgColor&&i.find(".sp-preview-inner").css("background-color",t.formData.bgColor),i.find(".cancel-btn").on("click",function(){e.close(o)})},content:'<form class="layui-form" lay-filter="imgComponentForm">\n        <div class="layui-tab layui-tab-brief">\n          <ul class="layui-tab-title">\n            <li class="layui-this">内容设置</li>\n            <li>动画设置</li>\n          </ul>\n          <div class="layui-tab-content">\n            <div class="layui-tab-item layui-show">\n              <div class="layui-form-item">\n                <label class="layui-form-label">应用名称</label>\n                <div class="layui-input-inline">\n                  <input type="text" name="appLabel" class="layui-input">\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">图片地址</label>\n                <div class="layui-input-inline">\n                  <input name="bgImg" type="text" class="layui-input">\n                </div>\n                <div><input name="bgImgSize" value="true" type="checkbox" lay-skin="primary" title="自动宽高"></div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">图片显示方式</label>\n                <div class="layui-input-inline">\n                  <select name="imgMode">\n                    <option value="cut">保持原图尺寸</option>\n                    <option value="full">自由拉伸</option>\n                    <option value="scaleX">保持比例(只裁剪宽度)</option>\n                    <option value="scaleY">保持比例(只裁剪高度)</option>\n                  </select>\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">背景颜色</label>\n                <div class="layui-input-inline" style="position:relative">\n                  <div class="sp-replacer sp-light" style="z-index: 2;bottom: auto;top: 10px">\n                    <div class="sp-preview">\n                      <div class="sp-preview-inner"></div>\n                    </div>\n                  </div>\n                  <input style="text-indent:28px;" name="bgColor" type="text" class="layui-input pagecolor">\n                  <span class="clear-color-button" style="right: 5px"></span>\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">链接类型</label>\n                <div class="layui-input-inline">\n                  <input type="radio" name="linkMode" value="urlink" title="普通" checked="">\n                  <input type="radio" name="linkMode" value="wwlink" title="旺旺">\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">链接地址</label>\n                <div class="layui-input-inline">\n                  <input name="href" type="text" class="layui-input">\n                </div>\n                <div><input name="hrefMode" value="_blank" type="checkbox" lay-skin="primary" title="新窗口打开"></div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">提示文字</label>\n                <div class="layui-input-inline">\n                  <input name="tipText" type="text" class="layui-input">\n                </div>\n              </div>\n            </div>\n            <div class="layui-tab-item" style="min-height: 356px">\n              <div class="layui-form-item">\n                <label class="layui-form-label">动画效果</label>\n                <div class="layui-input-inline">\n                  <div class="animselect ui-buttonset">\n                    <div class="none" data-val=""><i><em></em></i>无效果</div>\n                    <div class="shakex" data-val="xins-x-shake"><i><em></em></i>左右抖动</div>\n                    <div class="shakey" data-val="xins-y-shake"><i><em></em></i>上下抖动</div>\n                    <div class="shaker" data-val="xins-r-shake"><i><em></em></i>旋转摆动</div>\n                    <div class="shakes" data-val="xins-s-shake"><i><em></em></i>弹性缩放</div>\n                    <div class="shaken" data-val="xins-n-shake"><i><em></em></i>弹性果冻</div>\n                  </div>\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">链接类型</label>\n                <div class="layui-input-inline">\n                  <input type="radio" name="animRange" value="-s" title="弱" checked="">\n                  <input type="radio" name="animRange" value="-m" title="中">\n                  <input type="radio" name="animRange" value="-l" title="强">\n                </div>\n              </div>\n              <div class="layui-form-item">\n                <label class="layui-form-label">图片显示方式</label>\n                <div class="layui-input-inline">\n                  <select name="animSpeed">\n                    <option value="1s" selected="">1秒</option>\n                    <option value="2s">2秒</option>\n                    <option value="3s">3秒</option>\n                    <option value="4s">4秒</option>\n                  </select>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class="layui-form-item">\n          <div class="layui-input-block" style="margin-left: 440px;margin-top: 50px">\n            <button class="layui-btn" lay-submit lay-filter="imgComponentForm">确定</button>\n            <button type="button" class="cancel-btn layui-btn layui-btn-primary">取消</button>\n          </div>\n        </div>\n      </form>'}),o=layui.form;o.render(),o.on("submit(imgComponentForm)",function(o){o.field.bgImg!==t.formData.bgImg&&(t.$content.css("background-image","url("+o.field.bgImg+")"),t.$img.attr("src",o.field.bgImg)),o.field.bgColor!==t.formData.bgColor&&t.$content.css("background-color",o.field.bgColor),t.formData=o.field,"true"===t.formData.bgImgSize&&(t.$el.width(t.$img.width()),t.$el.height(t.$img.height()));var s=t.formData.imgMode;return"cut"===s?t.$img.is(":visible")&&(t.$content.css("background-image","url("+t.formData.bgImg+")"),t.$img.hide()):(t.$content.css("background-image",""),"full"===s?(t.$img.css("width","100%"),t.$img.css("height","100%")):"scaleX"===s?(t.$img.css("height","100%"),t.$img.css("width","")):"scaleY"===s&&(t.$img.css("width","100%"),t.$img.css("height","")),t.$img.show()),t.formData.animType=i.find(".animselect > div.active").data("val"),console.log(t.formData),e.close(n),!1}),o.val("imgComponentForm",t.formData)},r.prototype.getProps=function(){console.log(this.formData);var t=this.formData;return t.appID=this.stage.id+"-"+this.id,{appType:"xdtb",config:t,pos:{w:this.width(),h:this.height(),l:parseInt(this.$el.css("left")),t:parseInt(this.$el.css("top"))}}},r);function r(){var t=s.call(this,"img-component")||this;t.$content=$('<a><img src="" style="display:none"></a>'),t.$img=t.$content.find("img"),t.$contentBox.append(t.$content);var e=t;return t.$topBar.find(".setting").bind("click",function(){e.openEditDialog()}),t.$el.dblclick(function(){e.openEditDialog()}),t.initFormData(),t}e.default=l},function(t,e,i){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0});var s,a=i(0),l=(o(r,s=a.default),r.prototype.getProps=function(){return{}},r.prototype.toHtml=function(){return""},r);function r(){var t=s.call(this,"text-component")||this;return t.$contentBox.append("\n        <a>请双击设置文件内容</a>\n      "),t}e.default=l},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(o.prototype.generateJsonCode=function(){this.stageCt.curStage},o.prototype.openExportDialog=function(){var t=this;layui.layer.open({type:1,title:"生成代码",skin:"layui-layer-rim",area:["600px","550px"],success:function(e,i){var n=$(e),o=n.find("#jsonTextArea"),s=n.find("#htmlTextArea");o.val(t.stageCt.curStage.generateJsonCode()),s.val(t.stageCt.curStage.generateHtmlCode()),n.find(".page-width").val(t.stageCt.curStage.pageWidth),n.find(".page-height").val(t.stageCt.curStage.pageHeight)},content:'\n        <div class="codegen" style="padding: 15px 10px">\n          <div class="codegen-head">\n            <ul>\n              <li>\n                <label><span style="margin-left:10px;">当前模块宽</span>&nbsp;</label>\n                <input class="page-width" style="width:40px;" type="text" spellcheck="false">\n                <label>&nbsp;&nbsp;高&nbsp;</label>\n                <input class="page-height" style="width:40px;" type="text" spellcheck="false">\n                <label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当内容超出模块范围时：&nbsp;</label>\n                <div id="rm_o1">\n                  <input class="cfgl-rr" type="radio" id="m_o2" name="overflowMode" value="visible" spellcheck="false">\n                  <label class="cfgl-radio cfgl-radio-checked" for="m_o2" title="" style="border-right:none;border-radius:2px 0 0 2px;">显示</label>\n                  <input class="cfgl-rr" type="radio" id="m_o1" name="overflowMode" checked="checked" value="hidden" spellcheck="false">\n                  <label class="cfgl-radio" for="m_o1" title="" style="border-left:none;border-radius:0 2px 2px 0;">裁掉</label>\n                </div>\n              </li>\n            </ul>\n          </div>\n          <div class="layui-tab">\n            <ul class="layui-tab-title" style="font-size: 12px">\n              <li style="font-size: 12px" class="layui-this">JSON代码</li>\n              <li style="font-size: 12px">HTML代码</li>\n            </ul>\n            <div class="layui-tab-content">\n              <div class="layui-tab-item layui-show">\n                <textarea id="jsonTextArea"style="float:left;width:100%;height:320px;" readonly spellcheck="false"></textarea>\n              </div>\n              <div class="layui-tab-item">\n                <textarea id="htmlTextArea"style="float:left;width:100%;height:320px;" readonly spellcheck="false"></textarea>\n              </div>\n            </div>\n          </div>\n        </div>'})},o);function o(t){this.stageCt=t,this.$el=$(".header");var e=this;this.$el.find(".export-btn").bind("click",function(){e.openExportDialog()}),this.$el.find(".preview-btn").bind("click",function(){var t=window.open(""),i=window.location.href;t.document.write('<html><head><title></title><link rel="stylesheet" type="text/css" href="'+i+'css/common.css"></head><body>'),t.document.write(e.stageCt.curStage.generateHtmlCode()),t.document.write("</body></html>"),t.document.write(e.stageCt.curStage.generateHtmlCode()),t.focus(),t.document.title="预览"})}e.default=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(o.prototype.setStage=function(t){this.stage=t,this.pageWidth=t.pageWidth,this.pageHeight=t.pageHeight,this.$inputWidth.val(this.pageWidth),this.$inputHeight.val(this.pageHeight)},o);function o(){this.pageWidth=0,this.pageHeight=0;var t=$(".page-config"),e=t.find(".input-width"),i=t.find(".input-height"),n=t.find(".input-bg"),o=(t.find(".calc-width"),t.find(".calc-height"),t.find(".align-select")),s=t.find("#allowOverstep");this.$inputWidth=e,this.$inputHeight=i;var a=this;$(document).spectrum({showPalette:!0,maxSelectionSize:18,showInitial:!0,preferredFormat:"hex",showButtons:!1,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"]],move:function(t,e){if("inputBgColor"===e.attr("id")&&a.stage&&(t||(a.stage.$canvasBox.addClass("bg-trans"),a.stage.$canvas.css("background-color","transparent"),a.stage.props.bgColor="transparent"),"object"==typeof t)){var i=t.toHexString();a.stage.$canvasBox.removeClass("bg-trans"),a.stage.$canvas.css("background-color",i+""),a.stage.props.bgColor=i}}}).spectrum.freshSpan(),e.bind("input",function(){a.pageWidth=+$(this).val(),a.stage.setCanvasSize(a.pageWidth,a.pageHeight)}),i.bind("input",function(){a.pageHeight=+$(this).val(),a.stage.setCanvasSize(a.pageWidth,a.pageHeight)}),n.bind("input",function(){var t=$(this).val();a.stage.props.bgImg=t,a.stage.$canvas.css("background-image",'url("'+t+'")')}),o.change(function(){var t=$(this).val();a.stage.$canvas.css("background-position",""+t),a.stage.props.position=t}),s.bind("click",function(){s.hasClass("active")?(s.removeClass("active"),a.stage.props.overflow="hidden",a.stage.setComponentAllowOverstep(!1)):(s.addClass("active"),a.stage.props.overflow="visible",a.stage.setComponentAllowOverstep(!0))}),t.find(".bgImg-box .page-check").bind("click",function(){var t=$(this),e=t.data("val");console.log(e),t.hasClass("active")?(t.removeClass("active"),"repeat"===e&&(a.stage.$canvas.css("background-repeat",""),a.stage.props.repeat=""),"fixed"===e&&(a.stage.$canvas.css("background-attachment",""),a.stage.props.attachment="")):(t.addClass("active"),"repeat"===e&&(a.stage.$canvas.css("background-repeat","repeat"),a.stage.props.repeat="repeat"),"fixed"===e&&(a.stage.$canvas.css("background-attachment","fixed"),a.stage.props.attachment="fixed"))})}e.default=n}]);
//# sourceMappingURL=index.bundle.js.map